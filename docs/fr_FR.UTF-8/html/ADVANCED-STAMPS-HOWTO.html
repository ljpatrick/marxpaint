<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>
      'Guide pratique' pour les tampons  de haute qualité de Tux Paint    </title>
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8">
  </head>
  <body bgcolor="#FFFFFF"
        text="#000000"
        link="#0000FF"
        vlink="#FF0000"
        alink="#FF00FF">
    <center>
      <h1>
        <img src="../../html/images/tuxpaint-title.png"
            width="205"
            height="210"
            alt="Tux Paint"><br>
        version 0.9.26        'Guide pratique" pour les tampons de haute qualité      </h1>

      <p>
        Copyright &copy; 2006-2021 by Albert Cahalan et autres; cf AUTHORS.<br>
        <a href="http://www.tuxpaint.org/">http://www.tuxpaint.org/</a>
      </p>
    </center>

    <h2>
      À propos de ce  'guide pratique'    </h2>

    <blockquote>
      <p>
        Ce 'guide pratique' suppose que vous vouliez créer un excellent tampon pou Tux Paint, au format bitmap PNG, à partir d'une image JPEG (par ex. une photographie digitale). Il existe des méthodes plus faciles et plus rapides donnant de moins bons résultats.      </p>

      <p>
        Ce 'guide pratique' suppose que vous travaillez avec des objets normalement opaques. Pour des objets semi-transparents (flamme, hélice de ventilateur en mouvement) ou des objets luminescents (feu, ampoule, soleil) il vaut mieux travailler avec un logiciel adapté. Des images avec de parfaits arrière-plans de couleur unie sont mieux réalisées avec un logiciel adapté, mais ne posent pas de problèmes avec ce qui suit.      </p>
    </blockquote>

    <h2>
      Le choix de l'image est crucial    </h2>

    <blockquote>
      <h3>
        Licence      </h3>

      <blockquote>
        <p>
          Si vous voulez présenter une oeuvre aux développeurs de Tux Paint destinée à être incluse dans le projet officiel, ou si vous voulez faire une version de Tux Paint pour votre seul usage avec vos propre graphiques, vous devez avoir une image compatible avec la Licence Publique Générale GNU utilisée par Tux Paint.        </p>

        <p>
          Les images produites par le gouvernement US sont dans le domaine public, mais faites attention car le gouvernement US utilise parfois des images provenant du web. Une demande incluant soit <code>site:gov</code> soit <code>site:mil</code> sur <a href="http://images.google.com/">Google image</a> vous donnera beaucoup d'images qui conviendront. Note : les sites *.mil peuvent avoir aussi des contenus non-militaires !)        </p>

        <p>
          Vos propres images peuvent être placées dans le domaine public, ou sous une licence adéquate, telle que <a href="http://images.google.com/">Google image</a> en y faisant référence. (Demandez à un avocat si vous pensez que vous avez besoin d'un avis faisant autorité).        </p>

        <p>
          Pour un usage personnel, toute image que vous pouvez légalement modifier et utiliser pour vous-même devrait convenir.        </p>
      </blockquote>

      <h3>
        Taille et orientation de l'image      </h3>

      <blockquote>
        <p>
          Vous aurez besoin d'une image ayant une bonne orientation. La perspective est notre ennemie. Les images montrant un objet à partir d'un coin sont difficiles à intégrer pour obtenir un dessin correct. En règle générale, les photos prises au téléobjectif sont les meilleures. L'idéal, impossible à tenir, serait que deux roues d'une même voiture soient cachées derrière les deux autres.        </p>

        <p>
          Effectuer une rotation sur une image peut la rendre floue, surtout si vous ne la pivotez que de quelques degrés. Les meilleures images sont celles où il n'y a pas de rotation, et celles qui nécessitent beaucoup de rotation (30à 60 degrés) ne sont pas loin des meilleures, et celles qui ne nécessitent que quelques degrés sont les pires. La rotation rendra également l'image plus sombre car la plupart des logiciels de manipulation d'images sont très mauvais quant au traitement du gamma. (Le rotation ne se justifie qu'avec des images ayant un gamma de 1.0)        </p>

        <p>
          De très grandes images pardonnent plus facilement les erreurs, et sont donc plus faciles pour travailler. Choisissez une image avec un objet de plus de 1 000 pixels si possible. Vous pourrez ainsi la réduire et cacher vos erreurs.        </p>

        <p>
          Vérifiez bien que l'image ne soit pas trop granuleuse, pâle ou délavée.        </p>

        <p>
          Faites attention aux pieds et aux roues. Si elles sont camouflées par quelque chose, vous devrez en dessiner de nouvelles. Si une seule est camouflée, vous devriez pouvoir effectuer un copié-collé pour le remplacement.        </p>
      </blockquote>
    </blockquote>

    <h2>
      Préparez l'image    </h2>

    <blockquote>
      <p>
        Tout d'abord, ne re-sauvegardez pas une image au format JPEG. Cela induit une perte de qualité. Il existe un outil spécial appelé <a href="https://jpegclub.org/">jpegtran</a>  qui vous permet de découper une image sans la perte de qualité habituelle.      </p>

      <blockquote>
        <p>
          <code>jpegtran -trim -copy none -crop 512x1728+160+128 &lt; src.jpg &gt; cropped.jpg</code>
        </p>
      </blockquote>

      <p>
        Importez votre image dans votre éditeur d'image. Si vous n'avez pas encore recadrer votre image, vous pouvez trouver que votre éditeur est très lent. Faites une rotation et recadrer l'image comme vous voulez. Sauvegardez l'image -- choisissez tout format supportant les calques, les masques, alpha, etc... Les utilisateurs de <a href="http://www.gimp.org/">GIMP</a> choisiront le format XCF, et les utilisateurs de Adobe Photoshop choisiront PSD, à titre d'exemple.      </p>

      <p>
        Si vous avez effectué une rotation et un recadrage de votre image,  applatissez-la. Vous n'avez besoin que d'un seul calque RGB <i> sans masque ou canal alpha</i>.      </p>

      <p>
        Ouvrez la boîte de dialogue qui concerne les calques. Reproduisez une couche plusieurs fois. Du haut jusqu'en bas vous aurez besoin de quelque chose comme cela :      </p>

      <ol>
        <li>image non-modifiée (protégez la en écriture, si possible)</li>
        <li>une image que vous modifierez -- avec la couche "travail en cours"</li>
        <li>vert uni (si possible protégé en écriture)</li>
        <li>magenta uni (si possible protégé en écriture)</li>
        <li>image non-modifiée (protégez la en écriture, si possible)</li>
        </li>
      </ol>

      <p>
        Donnez au calque 'travail en cours' (WIP) un masque initial approximatif. Vous pouvez démarrer avec une sélection, ou en utilisant la valeur de niveaux de gris du calque WIP. Vous pouvez inverser le masque.      </p>

      <p>
        <b>Attention :</b> une fois que avez le masque, vous ne plus tourner ou modifier la taille de l'image de manière habituelle. Cela entraînerait des pertes de données. On vous donnera plus tard des instructions pour la mise à l'échelle.      </p>
    </blockquote>

    <h2>
      Préparez le masque    </h2>

    <blockquote>
      <p>
        Prenez l'habitude de faire un <b>[Ctrl]</b>-clic et un <b>[Alt]</b>-clic sur les images-vignettes dans la boîte de dialogue des calques. Vous devez le faire pour vérifier ce que vous voyez et ce que vous éditez. Parfois vous éditerez des choses que vous ne pouvez pas voir. Par exemple, vous pouvez éditer le masque du masque WIP, tout en regardant l'image non modifiée. Faites attention à ne pas vous tromper. Vérifiez toujours que vous éditez ce qu'il faut.      </p>

      <p>
        Définissez une image non-modifiée comme étant celle que vous voulez afficher (celle du haut est la plus facile). Définissez le masque WIP comme étant ce que vous allez éditer. À un moment donné, vous devriez agrandir l'image à à environ 400 % (chaque pixel de l'image est vu et représenté par un bloc de 4x4 pixels sur votre écran.      </p>

      <p>
        Sélectionnez les parties de l'image devant être 100 % opaques, ou bien 0 % opaques.Si vous pouvez sélectionner l'objet ou l'arrière-plan avec une bonne précision, faites le. Si nécessaire, pour éviter de sélectionner des pixels devant être partiellement opaques (en général sur les bords de l'objet), vous devriez agrandir, réduire et inverser la sélection.      </p>

      <p>
        Remplissez les zones 100 % opaques avec du blanc, et les 0 % opaques avec du noir. On le fait facilement en glissant-déposant depuis l'indicateur de couleur de premier plan. Vous ne devriez rien voir se produire, car vous voyez le calque de l'image non modifiée quand vous éditez le masque du calque WIP. Les changements importants peuvent être vus sur la vignette.      </p>

      <p>
        Maintenant vous devez zoomer.      </p>

      <p>
        Vérifiez votre travail. Cacher le calque supérieur d'image non-modifiée. N'affichez que le masque, qui devrait être un objet blanc sur un fond noir (probablement avec du gris non édité sur les bords). Maintenant affichez le calque WIP normalement, pour que le masque soit actif. Cela devrait montrer montrer votre objet par dessus le prochain calque activé le plus élevé, et qui devrait vert ou magenta suivant la nécessité d'avoir un contraste maximum. Vous pourriez basculer entre ces arrière-plans en cliquant plusieurs fois pour activer/désactiver le calque vert. Corrigez tous les problèmes évidents et faciles en éditant le masque.      </p>

      <p>
        Revenez à l'affichage du calque supérieur non modifié lors de l'édition du masque WIP. Ajustez le pinceau dans l'outil de dessin. Pour la brosse, choisissez un petit cercle flou. Une taille de 5x5 convient dans tous les cas.      </p>

      <p>
        Avec une main sûre, tracez autour de l'image. Utilisez du noir à l'extérieur et du blanc à l'intérieur. Évitez de faire plus d'un passage par couleur.      </p>

      <p>
        Inversez un peu les vues, pour vérifier que le masque fonctionne bien.Lorsque le calque WIP est fait de vert ou de magenta, vous devriez voir un tout petit peu de l'arrière-plan initial ressemblant à une vilaine frange près du bord. Si la frange est absente, c'est que le masque d'objet est trop petit. La frange est constituée de pixels qui ne sont ni à un objet à 100 % ni un objet à 0 %. Pour eux, le masque ne devrait être ni à 100 % ni à 0 %. La frange disparaîtra bientôt.       </p>

      <p>
        Affichez et modifiez le masque. Sélectionnez par couleur, en choisissant le noir ou le blanc. Sûrement vous verrez des tâches non sélectionnées qui ne sont pas tout à fait à la couleur attendue. Inversez la sélection, et coloriez les avec l'outil crayon. Faites ces opérations pour le blanc et le noir.      </p>
    </blockquote>

    <h2>
      Remplacer la frange et les pixels indésirables    </h2>

    <blockquote>
      <p>
        Still viewing the mask, select by color. Choose black. Shrink the selection by several pixels, being sure to NOT shrink from the edges of the mask (the shrink helps you avoid and recover from mistakes).      </p>

      <p>
        Now disable the mask. View and edit the unmasked WIP layer. Using the color picker tool, choose a color that is average for the object. Drag-and-drop this color into the selection, thus removing most of the non-object pixels.      </p>

      <p>
        This solid color will compress well and will help prevent ugly color fringes when Tux Paint scales the image down. If the edge of the object has multiple colors that are very different, you should split up your selection so that you can color the nearby background to be similar.      </p>

      <p>
        Now you will paint away the existing edge fringe. Be sure that you are editing and viewing the WIP image. Frequent layer visibility changes will help you to see what you are doing. You are likely to use all of:      </p>

      <ul>
        <li>composited over vert (mask enabled)</li>
        <li>composited over magenta (mask enabled)</li>
        <li>original (the top or bottom layer)</li>
        <li>composited over l'original (mask enabled)</li>
        <li>raw WIP layer (mask <strong>disabled</strong>)</li>
      </ul>

      <p>
        To reduce accidents, you may wish to select only those pixels that are not grey in the mask. (Select by color from the mask, choose black, add mode, choose white, invert. Alternately: Select all, select by color from the mask, subtract mode, choose black, choose white.) If you do this, you'll probably want to expand the selection a bit and/or hide the "crawling ants" line that marks the selection.      </p>

      <p>
        Use the clone tool and the brush tool. Vary the opacity as needed. Use small round brushes mostly, perhaps 3x3 or 5x5, fuzzy or not. (It is generally nice to pair up fuzzy brushes with 100% opacity and non-fuzzy brushes with about 70% opacity.) Unusual drawing modes can be helpful with semi-transparent objects.      </p>

      <p>
        The goal is to remove the edge fringe, both inside and outside of the object. The inside fringe, visible when the object is composited over magenta or green, must be removed for obvious reasons. The outside fringe must also be removed because it will become visible when the image is scaled down. As an example, consider a 2x2 region of pixels at the edge of a sharp-edged object. The left half is black and 0% opaque. The right half is white and 100% opaque. That is, we have a white object on a black background. When Tux Paint scales this to 50% (a 1x1 pixel area), the result will be a grey 50% opaque pixel. The correct result would be a white 50% opaque pixel. To get this result, we would paint away the black pixels. They matter, despite being 0% opaque.      </p>

      <p>
        Tux Paint can scale images down by a very large factor, so it is important to extend the edge of your object outward by a great deal. Right at the edge of your object, you should be very accurate about this. As you go outward away from the object, you can get a bit sloppy. It is reasonable to paint outward by a dozen pixels or more. The farther you go, the more Tux Paint can scale down without creating ugly color fringes. For areas that are more than a few pixels away from the object edge, you should use the pencil tool (or sloppy select with drag-and-drop color) to ensure that the result will compress well.      </p>
    </blockquote>

    <h2>
      Save the image for Tux Paint    </h2>

    <blockquote>
      <p>
        It is very easy to ruin your hard work. Image editors can silently destroy pixels in 0% opaque areas. The conditions under which this happens may vary from version to version. If you are very trusting, you can try saving your image directly as a PNG. Be sure to read it back in again to verify that the 0% opaque areas didn't turn black or white, which would create fringes when Tux Paint scales the image down. If you need to scale your image to save space (and hide your mistakes), you are almost certain to destroy all the 0% opaque areas. So here is a better way...      </p>

      <h3>
        A Safer Way to Save      </h3>

      <blockquote>
        <p>
          Drag the mask from the layers dialog to the unused portion of the toolbar (right after the last drawing tool). This will create a new image consisting of one layer that contains the mask data. Scale this as desired, remembering the settings you use. Often you should start with an image that is about 700 to 1500 pixels across, and end up with one that is 300 to 400.        </p>

        <p>
          Save the mask image as a NetPBM portable greymap ("<code>.pgm</code>") file. (If you are using an old release of The GIMP, you might need to convert the image to greyscale before you can save it.) Choose the more compact "RAW PGM" format. (The second character of the file should be the ASCII digit "5", hex byte 0x35.)        </p>

        <p>
          You may close the mask image.        </p>

        <p>
          Going back to the multi-layer image, now select the WIP layer. As you did with the mask, drag this from the layers dialog to the toolbar. You should get a single-layer image of your WIP data. If the mask came along too, get rid of it. You should be seeing the object and the painted-away surroundings, without any mask thumbnail in the layers dialog. If you scaled the mask, then scale this image in exactly the same way. Save this image as a NetPBM portable pixmap ("<code>.ppm</code>") file. (Note: <code>.ppm</code>, not <code>.pgm</code>.) (If you choose the RAW PPM format, the second byte of the file should be the ASCII digit "6", hex byte 0x36.)        </p>

        <p>
          Now you need to merge the two files into one. Do that with the <a href="http://netpbm.sourceforge.net/">pnmtopng</a> command, like this:        </p>

        <blockquote>
          <p>
            <code>pnmtopng -force -compression 9 -alpha mask.pgm fg.ppm &gt; final-stamp.png</code>
          </p>
        </blockquote>
      </blockquote>
    </blockquote>
  </body>
</html>
